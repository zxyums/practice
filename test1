import isEqual from 'lodash.isequal'; // Install this using `npm install lodash.isequal`

const handleSave = async () => {
  const currentValues = methods.getValues();
  const initialValues = methods.defaultValuesRef.current; // Default values from react-hook-form

  // Check if there are any changes by comparing currentValues and initialValues
  const hasChanges = !isEqual(currentValues, initialValues);

  if (!hasChanges) {
    setShowNoChangeAlerts(true);
    setTimeout(() => setShowNoChangeAlerts(false), 3000);
    console.log("No changes detected.");
    return; // Exit without saving
  }

  // Save logic if changes are detected
  setShowSaveLoading(true);
  try {
    const savePayload = { ...currentValues };
    await saveFormToServer(savePayload); // Example API call
    console.log("Form saved successfully.");
    setDraftStatus(false);

    // Optionally, update default values after a successful save
    methods.reset(currentValues);
  } catch (error) {
    console.error("Failed to save the form:", error);
    setErrorStatus(true);
  } finally {
    setShowSaveLoading(false);
  }
};