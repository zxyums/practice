import React, { useState, useEffect } from "react";
import { useForm } from "react-hook-form";

const ProgressForm = () => {
  const { register, handleSubmit, getValues, watch } = useForm();
  const [progress, setProgress] = useState(0);

  // Define the total number of form fields
  const totalFields = 3;

  // Watch all form values to update the progress
  const formValues = watch();

  useEffect(() => {
    // Calculate the filled form fields
    const filledFields = Object.values(getValues()).filter(Boolean).length;
    
    // Calculate progress as a percentage
    const calculatedProgress = (filledFields / totalFields) * 100;
    setProgress(calculatedProgress);
  }, [formValues, getValues]);

  const onSubmit = (data) => {
    console.log("Form Submitted:", data);
  };

  return (
    <div>
      <form onSubmit={handleSubmit(onSubmit)}>
        <label>
          Name:
          <input type="text" {...register("name")} />
        </label>
        <br />
        <label>
          Email:
          <input type="email" {...register("email")} />
        </label>
        <br />
        <label>
          Age:
          <input type="number" {...register("age")} />
        </label>
        <br />
        <button type="submit">Submit</button>
      </form>

      <div style={{ marginTop: "20px" }}>
        <div style={{ height: "10px", width: "100%", backgroundColor: "#e0e0df" }}>
          <div
            style={{
              height: "10px",
              width: `${progress}%`,
              backgroundColor: progress === 100 ? "green" : "blue",
              transition: "width 0.3s",
            }}
          ></div>
        </div>
        <p>{`Progress: ${Math.round(progress)}%`}</p>
      </div>
    </div>
  );
};

export default ProgressForm;